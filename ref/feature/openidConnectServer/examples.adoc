The OpenID Connect Provider feature can be configured to manage user authentication for OpenID Connect clients and microservices during development.


The OpenID Connect Provider (OP) can work directly with a user registry such as LDAP or act as an identity broker and delegate to another security provider.
In production, the application uses a cloud-hosted SSO provider.

Add the OP Open Liberty feature and any other needed features to the server.xml file.
Define an OAuth service provider.
Any user that is authorized to use OpenID Connect must also be mapped to the authenticated OAuth-role.

The following example assumes using basic registry which is available for purposes of development/test.
If using another method of authentication, for example, LDAP, replace the `basicRegistry` section with link:https://www.openliberty.io/docs/ref/feature/#ldapRegistry-3.0.html[LDAP] config.

The example uses `localStore` to store client data and token status, which means all client data and token status is held in memory, for test/development purposes.
If you use a database, replace the `localStore` section with link:https://www.openliberty.io/docs/ref/feature/#jdbc-4.3.html[JDBC] database configuration.
When using a database, clients are not specified in server.xml, instead they are added to the database through the registration endpoint.
If you reconfigure the server, `localStore` might be cleared.

<openidConnectProvider id="OidcConfigSample" oauthProviderRef="OAuthConfigSample" />

<oauthProvider id="OAuthConfigSample">
<localStore>
<!-- localstore is for test/dev use and not for production -->
<client name="client01" secret="{xor}LDo8LTor"
displayname="client01"
scope="openid profile email">
   <redirect>https://server.example.com:443/oidcclient/redirect/client01</redirect>
   <redirect>https://server2.example.com:443/oidcclient/redirect/client01</redirect>
</client>
</localStore>
</oauthProvider>

Configure the truststore of the server to include the signer certificates of the OpenID Connect Relying Parties, or clients, that are supported.

<sslDefault sslRef="DefaultSSLSettings" />
<ssl id="DefaultSSLSettings" keyStoreRef="myKeyStore" trustStoreRef="myTrustStore" />
<keyStore id="myKeyStore" password="{xor}Lz4sLCgwLTs=" type="jks" location="${server.config.dir}/resources/security/BasicKeyStore.jks" />
<keyStore id="myTrustStore" password="{xor}Lz4sLCgwLTs=" type="jks" location="${server.config.dir}/resources/security/BasicTrustStore.jks" />

OpenID Connect is configured to use the default SSL configuration that is specified by the server. Therefore, the default SSL configuration for the server must use the truststore that is configured for OpenID Connect.
